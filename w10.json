{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "url": "https://raw.githubusercontent.com/tay1203/Homework-Week10/refs/heads/main/nutrition.csv"
  },
  "params": [
    {
      "name": "Food",
      "value": "Big Mac"
    }
  ],
  "transform": [
    { "filter": { "param": "Food" } }
  ],
  "hconcat": [
    {
      "width": 600,
      "height": 300,
      "transform": [
        { "filter": "datum.Food == Food" },
        {
          "fold": [
            "Carbohydrate (g)",
            "Protein (g)",
            "Fat (g)",
            "Salt (g)",
            "Sugar (g)"
          ],
          "as": ["Nutrient", "Value"]
        }
      ],
      "mark": {
        "type": "bar",
        "tooltip": true,
        "color": "#FFCC00",
        "stroke": "#C8102E",
        "strokeWidth": 1
      },
      "encoding": {
        "x": {
          "field": "Value",
          "type": "quantitative",
          "title": "Amount (g)",
          "axis": {
            "labelColor": "#C8102E",
            "titleColor": "#C8102E"
          }
        },
        "y": {
          "field": "Nutrient",
          "type": "nominal",
          "title": null,
          "axis": {
            "labelColor": "#C8102E"
          }
        },
        "tooltip": [
          { "field": "Nutrient", "type": "nominal" },
          { "field": "Value", "type": "quantitative", "format": ".1f" }
        ]
      }
    },
    {
      "vconcat": [
        {
          "width": 200,
          "height": 200,
          "transform": [
            { "filter": "datum.Food == Food" },
            {
              "calculate": "2130 - datum['Energy (kcal)']",
              "as": "Remaining Calories"
            },
            {
              "calculate": "datum['Energy (kcal)'] / 2130 * 100",
              "as": "Percentage"
            }
          ],
          "layer": [
            {
              "transform": [
                {
                  "fold": ["Energy (kcal)", "Remaining Calories"],
                  "as": ["Category", "Value"]
                }
              ],
              "mark": {
                "type": "arc",
                "innerRadius": 50,
                "tooltip": true
              },
              "encoding": {
                "theta": {
                  "field": "Value",
                  "type": "quantitative",
                  "sort": "descending"
                },
                "color": {
                  "field": "Category",
                  "type": "nominal",
                  "scale": {
                    "domain": ["Energy (kcal)", "Remaining Calories"],
                    "range": ["#FFCC00", "#C8102E"]
                  },
                  "legend": {
                    "title": "Daily Calories (2130 kcal)"
                  }
                },
                "order": { "field": "Category", "sort": "descending" },
                "tooltip": [
                  { "field": "Category", "type": "nominal" },
                  { "field": "Value", "type": "quantitative", "format": ".0f" }
                ]
              }
            },
            {
              "mark": {
                "type": "text",
                "align": "center",
                "baseline": "middle",
                "fontSize": 20,
                "font": "Arial"
              },
              "encoding": {
                "text": {
                  "field": "Percentage",
                  "type": "quantitative",
                  "format": ".1f"
                },
                "y": { "value": 80 }
              }
            },
            {
              "mark": {
                "type": "text",
                "align": "center",
                "baseline": "middle",
                "fontSize": 12,
                "font": "Arial"
              },
              "encoding": {
                "text": { "value": "of Daily" },
                "y": { "value": 100 }
              }
            },
            {
              "mark": {
                "type": "text",
                "align": "center",
                "baseline": "middle",
                "fontSize": 12,
                "font": "Arial"
              },
              "encoding": {
                "text": { "value": "Recommended" },
                "y": { "value": 115 }
              }
            },
            {
              "mark": {
                "type": "text",
                "align": "center",
                "baseline": "middle",
                "fontSize": 12,
                "font": "Arial"
              },
              "encoding": {
                "text": { "value": "Calories" },
                "y": { "value": 130 }
              }
            }
          ]
        },
        {
          "width": 200,
          "height": 200,
          "transform": [
            { "filter": "datum.Food == Food" },
            {
              "calculate": "max(0, 36 - datum['Sugar (g)'])",
              "as": "Remaining Sugar"
            },
            {
              "calculate": "datum['Sugar (g)'] / 36 * 100",
              "as": "Percentage"
            }
          ],
          "layer": [
            {
              "transform": [
                {
                  "fold": ["Sugar (g)", "Remaining Sugar"],
                  "as": ["Category", "Value"]
                }
              ],
              "mark": {
                "type": "arc",
                "innerRadius": 50,
                "tooltip": true
              },
              "encoding": {
                "theta": {
                  "field": "Value",
                  "type": "quantitative",
                  "sort": "descending"
                },
                "color": {
                  "field": "Category",
                  "type": "nominal",
                  "scale": {
                    "domain": ["Sugar (g)", "Remaining Sugar"],
                    "range": ["#FFCC00", "#C8102E"]
                  },
                  "legend": {
                    "title": "Daily Sugar (36 g)"
                  }
                },
                "order": { "field": "Category", "sort": "descending" },
                "tooltip": [
                  { "field": "Category", "type": "nominal" },
                  { "field": "Value", "type": "quantitative", "format": ".0f" }
                ]
              }
            },
            {
              "mark": {
                "type": "text",
                "align": "center",
                "baseline": "middle",
                "fontSize": 20,
                "font": "Arial"
              },
              "encoding": {
                "text": {
                  "field": "Percentage",
                  "type": "quantitative",
                  "format": ".1f"
                },
                "y": { "value": 80 }
              }
            },
            {
              "mark": {
                "type": "text",
                "align": "center",
                "baseline": "middle",
                "fontSize": 12,
                "font": "Arial"
              },
              "encoding": {
                "text": { "value": "of Daily" },
                "y": { "value": 100 }
              }
            },
            {
              "mark": {
                "type": "text",
                "align": "center",
                "baseline": "middle",
                "fontSize": 12,
                "font": "Arial"
              },
              "encoding": {
                "text": { "value": "Recommended" },
                "y": { "value": 115 }
              }
            },
            {
              "mark": {
                "type": "text",
                "align": "center",
                "baseline": "middle",
                "fontSize": 12,
                "font": "Arial"
              },
              "encoding": {
                "text": { "value": "Sugar" },
                "y": { "value": 130 }
              }
            }
          ]
        }
      ]
    }
  ]
}
